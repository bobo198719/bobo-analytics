<script>

/* ===============================
   FORCE CHAT BUTTON TO WORK
================================= */

document.addEventListener("DOMContentLoaded", () => {

  const chatBtn = document.querySelector(".chat-btn");
  const chatBox = document.getElementById("chatBox");

  if(chatBtn){
    chatBtn.addEventListener("click", () => {
      chatBox.style.display =
        chatBox.style.display === "flex" ? "none" : "flex";
    });
  }

});


/* ===============================
   AI MESSAGE SYSTEM
================================= */

async function sendMessage(){

const input=document.getElementById("chatInput");
const msg=input.value.trim();
if(!msg) return;

const chat=document.getElementById("chatMessages");

chat.innerHTML+=`<div class="user">${msg}</div>`;
input.value="";

const thinking=document.createElement("div");
thinking.className="bot";
thinking.innerText="Thinking...";
chat.appendChild(thinking);

try{

const res = await fetch("/api/chat",{
method:"POST",
headers:{ "Content-Type":"application/json"},
body:JSON.stringify({message:msg})
});

const data = await res.json();

thinking.remove();

chat.innerHTML+=`<div class="bot">${data.reply}</div>`;
chat.scrollTop=chat.scrollHeight;

}catch(e){

thinking.innerText="AI connection error.";

}

}

</script>
